<?php

/*
 * Tooltip JS package for Bear Framework
 * https://github.com/ivopetkov/tooltip-js-bearframework-addon
 * Copyright (c) Ivo Petkov
 * Free to use under the MIT license.
 */

return <<<'EOT'
var ivoPetkov=ivoPetkov||{};ivoPetkov.bearFrameworkAddons=ivoPetkov.bearFrameworkAddons||{},ivoPetkov.bearFrameworkAddons.tooltip=ivoPetkov.bearFrameworkAddons.tooltip||function(){var t=0,e={},o=null;clientPackages.get("escapeKey").then((function(t){o=t}));var n=function(t){if(i(t)){var o=e[t],n=o[0],a=o[1],l=o[3],d=o[4],p=l.align,s=l.contentSpacing,v=l.arrowSize,c=a.style.backgroundColor,f=l.preferedPositions;a.style.top="-1000vh",a.style.left="-1000vw";for(var h=a.parentNode,w=window.innerWidth,y=window.innerHeight,m=n.getBoundingClientRect(),g=a.getBoundingClientRect(),b=h.getBoundingClientRect(),x=m.left,k=m.top,C=m.width,P=m.height,z=g.width,S=g.height,W=u(n),L=-1;L<W.length;L++){if(-1===L)var O=0,A=0,E=w,N=y;else{var H=W[L].getBoundingClientRect();O=H.top,A=H.left,E=H.width,N=H.height}if(O>k+P||O+N<k||A>A+C||A+E<A)return void r(t)}var D={};for(var F in f){var R=("top"===(M=f[F])||"bottom"===M?S+s:z+s)+5;R<1&&(R=1);var B=0;"top"===M?B=k:"bottom"===M?B=y-k-P:"left"===M?B=x:"right"===M&&(B=w-x-C),D[M]=R<B?2:1+B/R}var I=null,K=0;for(var F in f){var M;D[M=f[F]]>K&&(K=D[M],I=M)}var T=!1,q=!1;K>0&&K<2&&("top"===I||"bottom"===I?q=!0:"left"!==I&&"right"!==I||(T=!0));var V=0,j=0;if("top"===I?(V=k-S-s,j=x):"bottom"===I?(V=k+P+s,j=x):"left"===I?(V=k,j=x-z-s):"right"===I&&(V=k,j=x+C+s),"top"===I||"bottom"===I?("center"===p?j-=Math.floor((z-C)/2):"end"===p&&(j-=z-C),j+z+2>w&&(j=w-2-z)):"left"!==I&&"right"!==I||("center"===p?V-=Math.floor((S-P)/2):"end"===p&&(V-=S-P),V+S+2>y&&(V=y-2-S)),j<5&&(j=5),j+z>w-5&&(j=w-5-z),V<5&&(V=5),V+S>y-5&&(V=y-5-S),v>0){var G=null,J=null;if(T||q||("top"===I||"bottom"===I?(J="top"===I?S:-2*v,((G=x-j+(C-2*v)/2)<0||G>z-2*v)&&(G=null)):"left"!==I&&"right"!==I||(G="left"===I?z:-2*v,((J=k-V+(P-2*v)/2)<0||J>S-2*v)&&(J=null))),null!==G&&null!==J){var Q={top:c+" transparent transparent transparent",bottom:"transparent transparent "+c+" transparent",left:"transparent transparent transparent "+c,right:"transparent "+c+" transparent transparent"};a.style.setProperty("--tooltip-internal-arrow-size",v+"px"),a.style.setProperty("--tooltip-internal-arrow-colors",Q[I]),a.style.setProperty("--tooltip-internal-arrow-display","block"),a.style.setProperty("--tooltip-internal-arrow-left",G+"px"),a.style.setProperty("--tooltip-internal-arrow-top",J+"px")}else a.style.removeProperty("--tooltip-internal-arrow-display"),a.style.removeProperty("--tooltip-internal-arrow-left"),a.style.removeProperty("--tooltip-internal-arrow-top")}null===d&&(V-=b.top,j-=b.left),a.style.top=V+"px",a.style.left=j+"px"}},r=function(t){if(i(t)){for(var n=f(t),a=0;a<n.length;a++)r(n[a]);var l=e[t],d=l[1],p=k(t);if(o.removeHandler(l[2]),d.parentNode.removeChild(d),delete e[t],null!==p.onHide)try{p.onHide()}catch(t){}}},i=function(t){return void 0!==e[t]},a=function(t,o){if(void 0!==e[t]&&e[t][0].contains(o))return!0;return!1},l=function(t,o){if(void 0!==e[t]&&e[t][1].contains(o))return!0;return!1},d=function(t){var o=[];if(void 0!==e[t]){var n=e[t];for(var r in e)r!==t&&l(r,n[0])&&(o.push(r),o=o.concat(d(r)))}return h(o)},p=function(t){for(;null!==t.parentNode&&t!==document.body;){if("fixed"===getComputedStyle(t).position)return t;t=t.parentNode}return null},s=function(t){for(;null!==t.parentNode&&t!==document.body;){var e=getComputedStyle(t).zIndex;if(null!==e&&!isNaN(e))return e;t=t.parentNode}return null},u=function(t){for(var e=[];null!==t&&t!==document.body;)(t.scrollTop>0||t.scrollLeft>0)&&e.push(t),t=t.parentNode;return e},v=[],c=function(t){for(;null!==t.parentNode&&t!==document.body;)-1===v.indexOf(t)&&(t.addEventListener("scroll",m),v.push(t)),t=t.parentNode},f=function(t){var o=[];if(void 0!==e[t])for(var n in e)n!==t&&l(t,e[n][0])&&(o.push(n),o=o.concat(f(n)));return h(o)},h=t=>t.filter((t,e,o)=>o.indexOf(t)===e),w=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)},y=null,m=function(){y=!0},g=function(){null!==y&&(!function(){for(var t in e)n(t)}(),y=null),w(g)};g();var b=window.innerWidth,x=function(){if(b!==window.innerWidth){for(var t in e)k(t).hideOnWindowWidthChange&&r(t);b=window.innerWidth}},k=function(t){return void 0!==e[t]?e[t][3]:null},C=!1,P=function(){if(!C&&null!==document.body){C=!0,document.body.addEventListener("mousedown",(function(t){var o=t.target,n=[];for(var i in e){k(i).hideOnClick||(a(i,o)||l(i,o))&&(n.push(i),n=n.concat(d(i)))}for(var i in n=h(n),e)-1===n.indexOf(i)&&r(i)})),document.body.addEventListener("keydown",(function(){for(var t in e){k(t).hideOnKeyDown&&r(t)}})),window.addEventListener("resize",x),document.addEventListener("scroll",m),window.addEventListener("resize",m),window.addEventListener("orientationchange",m);var t=document.createElement("style");'[data-tooltip]:before{content:"";top:0;left:0;display:block;width:0;height:0;border-color:var(--tooltip-internal-arrow-colors);border-width:var(--tooltip-internal-arrow-size,0);border-style:solid;z-index:1;position:absolute;transform:rotate(0);display:var(--tooltip-internal-arrow-display,none);top:var(--tooltip-internal-arrow-top,0);left:var(--tooltip-internal-arrow-left,0);}',t.innerHTML='[data-tooltip]{position:relative;box-sizing:border-box;max-width:calc(100vw - 10px);max-height:calc(100vh - 10px);}[data-tooltip]:before{content:"";top:0;left:0;display:block;width:0;height:0;border-color:var(--tooltip-internal-arrow-colors);border-width:var(--tooltip-internal-arrow-size,0);border-style:solid;z-index:1;position:absolute;transform:rotate(0);display:var(--tooltip-internal-arrow-display,none);top:var(--tooltip-internal-arrow-top,0);left:var(--tooltip-internal-arrow-left,0);}',document.head.appendChild(t)}};document.addEventListener("readystatechange",()=>{P()}),P();return{generateID:function(){return"tt"+ ++t},show:function(t,a,l,d){i(t)&&r(t),void 0===d&&(d={}),void 0===d.align&&(d.align="center"),void 0!==d.showArrow&&!1===d.showArrow&&(d.arrowSize=0),void 0===d.preferedPositions&&(d.preferedPositions=["bottom","top","left","right"]),void 0===d.onHide&&(d.onHide=null),void 0===d.hideOnWindowWidthChange&&(d.hideOnWindowWidthChange=!1),void 0===d.hideOnClick&&(d.hideOnClick=!1),void 0===d.hideOnKeyDown&&(d.hideOnKeyDown=!1);var u=function(){if(i(t))return r(t),!0},v=document.body;if(void 0!==d.contentContainer){v=d.contentContainer;var f=getComputedStyle(v).position;-1===["relative","absolute","fixed"].indexOf(f)&&v.style.setProperty("position","relative")}var h=v===document.body?p(a):null,w=s(a),y=document.createElement("div");y.setAttribute("data-tooltip",""),y.setAttribute("role","tooltip"),y.style.position=null!==h?"fixed":"absolute",y.style.zIndex=(null!==w?w:0)+10,"string"==typeof l?y.innerHTML=l:y.appendChild(l),v.appendChild(y);var m=getComputedStyle(y),g=function(t,e){var o=m.getPropertyValue(t);return""!==o?o:e},b=null;if(void 0!==d.onBeforeShow)try{var x=d.onBeforeShow(y);"object"==typeof x&&"function"==typeof x.then&&(b=x)}catch(t){}var k=function(){if(void 0===d.contentSpacing&&(d.contentSpacing=parseInt(g("--tooltip-content-spacing","12px").replace("px",""))),void 0===d.arrowSize&&(d.arrowSize=parseInt(g("--tooltip-arrow-size","8px").replace("px",""))),void 0===d.maxWidth&&(d.maxWidth=g("--tooltip-max-width",null)),null!==d.maxWidth&&(y.style.maxWidth=d.maxWidth),e[t]=[a,y,u,d,h],y.style.backgroundColor=g("--tooltip-background-color","#eee"),y.style.border=g("--tooltip-border"),y.style.borderRadius=g("--tooltip-border-radius"),n(t),c(a),o.addHandler(u),void 0!==d.onShow)try{d.onShow(y)}catch(t){}};null!==b?b.then(k):k()},hide:r,hideAll:function(){for(var t in e)r(t)},isVisible:i,addClickListener:function(t,e,o){void 0===o&&(o={});var n=void 0!==o.preventDefault&&o.preventDefault,r=void 0!==o.stopPropagation&&o.stopPropagation;t.addEventListener("click",(function(t){n&&t.preventDefault(),r&&t.stopPropagation(),e()}))}}}();
EOT;
