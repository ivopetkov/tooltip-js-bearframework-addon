<?php

/*
 * Tooltip JS package for Bear Framework
 * https://github.com/ivopetkov/tooltip-js-bearframework-addon
 * Copyright (c) Ivo Petkov
 * Free to use under the MIT license.
 */

return <<<'EOT'
var ivoPetkov=ivoPetkov||{};ivoPetkov.bearFrameworkAddons=ivoPetkov.bearFrameworkAddons||{},ivoPetkov.bearFrameworkAddons.tooltip=ivoPetkov.bearFrameworkAddons.tooltip||function(){var t=0,e={},o=null;clientPackages.get("escapeKey").then((function(t){o=t}));var n=function(t){if(a(t)){var o=e[t],n=o[0],r=o[1],l=o[3],d=o[4],p=l.align,s=l.contentSpacing,u=l.arrowSize,f=r.style.backgroundColor,c=l.preferedPositions;r.style.top="-1000vh",r.style.left="-1000vw";for(var h=r.parentNode,w=window.innerWidth,y=window.innerHeight,b=n.getBoundingClientRect(),m=r.getBoundingClientRect(),g=h.getBoundingClientRect(),x=b.left,k=b.top,C=b.width,P=b.height,z=m.width,O=m.height,S=v(n),W=-1;W<S.length;W++){if(-1===W)var L=0,A=0,E=w,N=y;else{var H=S[W].getBoundingClientRect();L=H.top,A=H.left,E=H.width,N=H.height}if(L>k+P||L+N<k||A>A+C||A+E<A)return void i(t)}var D={};for(var F in c){var R=("top"===(K=c[F])||"bottom"===K?O+s:z+s)+5;R<1&&(R=1);var B=0;"top"===K?B=k:"bottom"===K?B=y-k-P:"left"===K?B=x:"right"===K&&(B=w-x-C),D[K]=R<B?2:1+B/R}var M=null,I=0;for(var F in c){var K;D[K=c[F]]>I&&(I=D[K],M=K)}var T=!1,q=!1;I>0&&I<2&&("top"===M||"bottom"===M?q=!0:"left"!==M&&"right"!==M||(T=!0));var V=0,j=0;if("top"===M?(V=k-O-s,j=x):"bottom"===M?(V=k+P+s,j=x):"left"===M?(V=k,j=x-z-s):"right"===M&&(V=k,j=x+C+s),"top"===M||"bottom"===M?("center"===p?j-=Math.floor((z-C)/2):"end"===p&&(j-=z-C),j+z+2>w&&(j=w-2-z)):"left"!==M&&"right"!==M||("center"===p?V-=Math.floor((O-P)/2):"end"===p&&(V-=O-P),V+O+2>y&&(V=y-2-O)),j<5&&(j=5),j+z>w-5&&(j=w-5-z),V<5&&(V=5),V+O>y-5&&(V=y-5-O),u>0){var G=null,J=null;if(T||q||("top"===M||"bottom"===M?(J="top"===M?O:-2*u,((G=x-j+(C-2*u)/2)<0||G>z-2*u)&&(G=null)):"left"!==M&&"right"!==M||(G="left"===M?z:-2*u,((J=k-V+(P-2*u)/2)<0||J>O-2*u)&&(J=null))),null!==G&&null!==J){var Q={top:f+" transparent transparent transparent",bottom:"transparent transparent "+f+" transparent",left:"transparent transparent transparent "+f,right:"transparent "+f+" transparent transparent"};r.style.setProperty("--tooltip-internal-arrow-size",u+"px"),r.style.setProperty("--tooltip-internal-arrow-colors",Q[M]),r.style.setProperty("--tooltip-internal-arrow-display","block"),r.style.setProperty("--tooltip-internal-arrow-left",G+"px"),r.style.setProperty("--tooltip-internal-arrow-top",J+"px")}else r.style.removeProperty("--tooltip-internal-arrow-display"),r.style.removeProperty("--tooltip-internal-arrow-left"),r.style.removeProperty("--tooltip-internal-arrow-top")}null===d&&(V-=g.top,j-=g.left),r.style.top=V+"px",r.style.left=j+"px"}},r=function(t,r,l,d){a(t)&&i(t),void 0===d&&(d={}),void 0===d.align&&(d.align="center"),void 0!==d.showArrow&&!1===d.showArrow&&(d.arrowSize=0),void 0===d.preferedPositions&&(d.preferedPositions=["bottom","top","left","right"]),void 0===d.onHide&&(d.onHide=null),void 0===d.hideOnWindowWidthChange&&(d.hideOnWindowWidthChange=!1),void 0===d.hideOnClick&&(d.hideOnClick=!1),void 0===d.hideOnKeyDown&&(d.hideOnKeyDown=!1);var p=function(){if(a(t))return i(t),!0},v=document.body;if(void 0!==d.contentContainer){v=d.contentContainer;var f=getComputedStyle(v).position;-1===["relative","absolute","fixed"].indexOf(f)&&v.style.setProperty("position","relative")}var h=v===document.body?s(r):null,w=u(r),y=document.createElement("div");if(y.setAttribute("data-tooltip",""),y.setAttribute("role","tooltip"),y.style.position=null!==h?"fixed":"absolute",y.style.zIndex=(null!==w?w:0)+10,void 0!==d.attributes){var b=d.attributes;for(var m in b)y.setAttribute(m,b[m])}"string"==typeof l?y.innerHTML=l:y.appendChild(l),v.appendChild(y);var g=getComputedStyle(y),x=function(t,e){var o=g.getPropertyValue(t);return""!==o?o:e},k=null;if(void 0!==d.onBeforeShow)try{var C=d.onBeforeShow(y);"object"==typeof C&&"function"==typeof C.then&&(k=C)}catch(t){}var P=function(){if(void 0===d.contentSpacing&&(d.contentSpacing=parseInt(x("--tooltip-content-spacing","12px").replace("px",""))),void 0===d.arrowSize&&(d.arrowSize=parseInt(x("--tooltip-arrow-size","8px").replace("px",""))),void 0===d.maxWidth&&(d.maxWidth=x("--tooltip-max-width",null)),null!==d.maxWidth&&(y.style.maxWidth=d.maxWidth),e[t]=[r,y,p,d,h],y.style.backgroundColor=x("--tooltip-background-color","#eee"),y.style.border=x("--tooltip-border"),y.style.borderRadius=x("--tooltip-border-radius"),n(t),c(r),o.addHandler(p),void 0!==d.onShow)try{d.onShow(y)}catch(t){}};null!==k?k.then(P):P()},i=function(t){if(a(t)){for(var n=h(t),r=0;r<n.length;r++)i(n[r]);var l=e[t],d=l[1],p=C(t);if(o.removeHandler(l[2]),d.parentNode.removeChild(d),delete e[t],null!==p.onHide)try{p.onHide()}catch(t){}}},a=function(t){return void 0!==e[t]},l=function(t,o){if(void 0!==e[t]&&e[t][0].contains(o))return!0;return!1},d=function(t,o){if(void 0!==e[t]&&e[t][1].contains(o))return!0;return!1},p=function(t){var o=[];if(void 0!==e[t]){var n=e[t];for(var r in e)r!==t&&d(r,n[0])&&(o.push(r),o=o.concat(p(r)))}return w(o)},s=function(t){for(;null!==t.parentNode&&t!==document.body;){if("fixed"===getComputedStyle(t).position)return t;t=t.parentNode}return null},u=function(t){for(;null!==t.parentNode&&t!==document.body;){var e=getComputedStyle(t).zIndex;if(null!==e&&!isNaN(e))return e;t=t.parentNode}return null},v=function(t){for(var e=[];null!==t&&t!==document.body;)(t.scrollTop>0||t.scrollLeft>0)&&e.push(t),t=t.parentNode;return e},f=[],c=function(t){for(;null!==t.parentNode&&t!==document.body;)-1===f.indexOf(t)&&(t.addEventListener("scroll",m),f.push(t)),t=t.parentNode},h=function(t){var o=[];if(void 0!==e[t])for(var n in e)n!==t&&d(t,e[n][0])&&(o.push(n),o=o.concat(h(n)));return w(o)},w=t=>t.filter((t,e,o)=>o.indexOf(t)===e),y=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)},b=null,m=function(){b=!0},g=function(){null!==b&&(!function(){for(var t in e)n(t)}(),b=null),y(g)};g();var x=window.innerWidth,k=function(){if(x!==window.innerWidth){for(var t in e)C(t).hideOnWindowWidthChange&&i(t);x=window.innerWidth}},C=function(t){return void 0!==e[t]?e[t][3]:null},P=!1,z=function(){if(!P&&null!==document.body){P=!0,document.body.addEventListener("mousedown",(function(t){var o=t.target,n=[];for(var r in e){C(r).hideOnClick||(l(r,o)||d(r,o))&&(n.push(r),n=n.concat(p(r)))}for(var r in n=w(n),e)-1===n.indexOf(r)&&i(r)})),document.body.addEventListener("keydown",(function(){for(var t in e){C(t).hideOnKeyDown&&i(t)}})),window.addEventListener("resize",k),document.addEventListener("scroll",m),window.addEventListener("resize",m),window.addEventListener("orientationchange",m);var t=document.createElement("style");'[data-tooltip]:before{content:"";top:0;left:0;display:block;width:0;height:0;border-color:var(--tooltip-internal-arrow-colors);border-width:var(--tooltip-internal-arrow-size,0);border-style:solid;z-index:1;position:absolute;transform:rotate(0);display:var(--tooltip-internal-arrow-display,none);top:var(--tooltip-internal-arrow-top,0);left:var(--tooltip-internal-arrow-left,0);}',t.innerHTML='[data-tooltip]{position:relative;box-sizing:border-box;max-width:calc(100vw - 10px);max-height:calc(100vh - 10px);}[data-tooltip]:before{content:"";top:0;left:0;display:block;width:0;height:0;border-color:var(--tooltip-internal-arrow-colors);border-width:var(--tooltip-internal-arrow-size,0);border-style:solid;z-index:1;position:absolute;transform:rotate(0);display:var(--tooltip-internal-arrow-display,none);top:var(--tooltip-internal-arrow-top,0);left:var(--tooltip-internal-arrow-left,0);}',document.head.appendChild(t),"undefined"!=typeof MutationObserver&&new MutationObserver((function(){for(var t in e)document.body.contains(e[t][0])||i(t)})).observe(document.body,{attributes:!0,childList:!0,subtree:!0})}};document.addEventListener("readystatechange",()=>{z()}),z();return{generateID:function(){return"tt"+ ++t},show:r,hide:i,hideAll:function(){for(var t in e)i(t)},toggle:function(t,e,o,n){a(t)?i(t):r(t,e,o,n)},isVisible:a,hasVisible:function(){for(var t in e)return!0;return!1},addClickListener:function(t,e,o){void 0===o&&(o={});var n=void 0!==o.preventDefault&&o.preventDefault,r=void 0!==o.stopPropagation&&o.stopPropagation;t.addEventListener("click",(function(t){n&&t.preventDefault(),r&&t.stopPropagation(),e()}))}}}();
EOT;
