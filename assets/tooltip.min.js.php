<?php

/*
 * Tooltip JS package for Bear Framework
 * https://github.com/ivopetkov/tooltip-js-bearframework-addon
 * Copyright (c) Ivo Petkov
 * Free to use under the MIT license.
 */

return <<<'EOT'
var ivoPetkov=ivoPetkov||{};ivoPetkov.bearFrameworkAddons=ivoPetkov.bearFrameworkAddons||{},ivoPetkov.bearFrameworkAddons.tooltip=ivoPetkov.bearFrameworkAddons.tooltip||function(){var t=0,o={},e=null;clientPackages.get("escapeKey").then((function(t){e=t}));var n=function(t){if(i(t)){var e=o[t],n=e[0],a=e[1],l=e[3],d=e[4],p=l.align,s=l.showArrow,v=l.contentSpacing,c=l.arrowSize,f=a.style.backgroundColor,h=l.preferedPositions;a.style.top="-1000vh",a.style.left="-1000vw";for(var w=a.parentNode,y=window.innerWidth,m=window.innerHeight,g=n.getBoundingClientRect(),b=a.getBoundingClientRect(),x=w.getBoundingClientRect(),k=g.left,C=g.top,P=g.width,z=g.height,W=b.width,S=b.height,A=u(n),L=-1;L<A.length;L++){if(-1===L)var O=0,E=0,N=y,H=m;else{var D=A[L].getBoundingClientRect();O=D.top,E=D.left,N=D.width,H=D.height}if(O>C+z||O+H<C||E>E+P||E+N<E)return void r(t)}var F={};for(var R in h){var B=("top"===(T=h[R])||"bottom"===T?S+v:W+v)+5;B<1&&(B=1);var I=0;"top"===T?I=C:"bottom"===T?I=m-C-z:"left"===T?I=k:"right"===T&&(I=y-k-P),F[T]=B<I?2:1+I/B}var K=null,M=0;for(var R in h){var T;F[T=h[R]]>M&&(M=F[T],K=T)}var q=!1,V=!1;M>0&&M<2&&("top"===K||"bottom"===K?V=!0:"left"!==K&&"right"!==K||(q=!0));var j=0,G=0;if("top"===K?(j=C-S-v,G=k):"bottom"===K?(j=C+z+v,G=k):"left"===K?(j=C,G=k-W-v):"right"===K&&(j=C,G=k+P+v),"top"===K||"bottom"===K?("center"===p?G-=Math.floor((W-P)/2):"end"===p&&(G-=W-P),G+W+2>y&&(G=y-2-W)):"left"!==K&&"right"!==K||("center"===p?j-=Math.floor((S-z)/2):"end"===p&&(j-=S-z),j+S+2>m&&(j=m-2-S)),G<5&&(G=5),G+W>y-5&&(G=y-5-W),j<5&&(j=5),j+S>m-5&&(j=m-5-S),s){var J=null,Q=null;if(q||V||("top"===K||"bottom"===K?(Q="top"===K?S:-2*c,((J=k-G+(P-2*c)/2)<0||J>W-2*c)&&(J=null)):"left"!==K&&"right"!==K||(J="left"===K?W:-2*c,((Q=C-j+(z-2*c)/2)<0||Q>S-2*c)&&(Q=null))),null!==J&&null!==Q){var U={top:f+" transparent transparent transparent",bottom:"transparent transparent "+f+" transparent",left:"transparent transparent transparent "+f,right:"transparent "+f+" transparent transparent"};a.style.setProperty("--tooltip-internal-arrow-size",c+"px"),a.style.setProperty("--tooltip-internal-arrow-colors",U[K]),a.style.setProperty("--tooltip-internal-arrow-display","block"),a.style.setProperty("--tooltip-internal-arrow-left",J+"px"),a.style.setProperty("--tooltip-internal-arrow-top",Q+"px")}else a.style.removeProperty("--tooltip-internal-arrow-display"),a.style.removeProperty("--tooltip-internal-arrow-left"),a.style.removeProperty("--tooltip-internal-arrow-top")}null===d&&(j-=x.top,G-=x.left),a.style.top=j+"px",a.style.left=G+"px"}},r=function(t){if(i(t)){for(var n=f(t),a=0;a<n.length;a++)r(n[a]);var l=o[t],d=l[1],p=k(t);if(e.removeHandler(l[2]),d.parentNode.removeChild(d),delete o[t],null!==p.onHide)try{p.onHide()}catch(t){}}},i=function(t){return void 0!==o[t]},a=function(t,e){if(void 0!==o[t]&&o[t][0].contains(e))return!0;return!1},l=function(t,e){if(void 0!==o[t]&&o[t][1].contains(e))return!0;return!1},d=function(t){var e=[];if(void 0!==o[t]){var n=o[t];for(var r in o)r!==t&&l(r,n[0])&&(e.push(r),e=e.concat(d(r)))}return h(e)},p=function(t){for(;null!==t.parentNode&&t!==document.body;){if("fixed"===getComputedStyle(t).position)return t;t=t.parentNode}return null},s=function(t){for(;null!==t.parentNode&&t!==document.body;){var o=getComputedStyle(t).zIndex;if(null!==o&&!isNaN(o))return o;t=t.parentNode}return null},u=function(t){for(var o=[];null!==t&&t!==document.body;)(t.scrollTop>0||t.scrollLeft>0)&&o.push(t),t=t.parentNode;return o},v=[],c=function(t){for(;null!==t.parentNode&&t!==document.body;)-1===v.indexOf(t)&&(t.addEventListener("scroll",m),v.push(t)),t=t.parentNode},f=function(t){var e=[];if(void 0!==o[t])for(var n in o)n!==t&&l(t,o[n][0])&&(e.push(n),e=e.concat(f(n)));return h(e)},h=t=>t.filter((t,o,e)=>e.indexOf(t)===o),w=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)},y=null,m=function(){y=!0},g=function(){null!==y&&(!function(){for(var t in o)n(t)}(),y=null),w(g)};g();var b=window.innerWidth,x=function(){if(b!==window.innerWidth){for(var t in o)k(t).hideOnWindowWidthChange&&r(t);b=window.innerWidth}},k=function(t){return void 0!==o[t]?o[t][3]:null},C=!1,P=function(){if(!C&&null!==document.body){C=!0,document.body.addEventListener("mousedown",(function(t){var e=t.target,n=[];for(var i in o){k(i).hideOnClick||(a(i,e)||l(i,e))&&(n.push(i),n=n.concat(d(i)))}for(var i in n=h(n),o)-1===n.indexOf(i)&&r(i)})),document.body.addEventListener("keydown",(function(){for(var t in o){k(t).hideOnKeyDown&&r(t)}})),window.addEventListener("resize",x),document.addEventListener("scroll",m),window.addEventListener("resize",m),window.addEventListener("orientationchange",m);var t=document.createElement("style");'[data-tooltip]:before{content:"";top:0;left:0;display:block;width:0;height:0;border-color:var(--tooltip-internal-arrow-colors);border-width:var(--tooltip-internal-arrow-size,0);border-style:solid;z-index:1;position:absolute;transform:rotate(0);display:var(--tooltip-internal-arrow-display,none);top:var(--tooltip-internal-arrow-top,0);left:var(--tooltip-internal-arrow-left,0);}',t.innerHTML='[data-tooltip]{position:relative;box-sizing:border-box;max-width:calc(100vw - 10px);max-height:calc(100vh - 10px);}[data-tooltip]:before{content:"";top:0;left:0;display:block;width:0;height:0;border-color:var(--tooltip-internal-arrow-colors);border-width:var(--tooltip-internal-arrow-size,0);border-style:solid;z-index:1;position:absolute;transform:rotate(0);display:var(--tooltip-internal-arrow-display,none);top:var(--tooltip-internal-arrow-top,0);left:var(--tooltip-internal-arrow-left,0);}',document.head.appendChild(t)}};document.addEventListener("readystatechange",()=>{P()}),P();return{generateID:function(){return"tt"+ ++t},show:function(t,a,l,d){i(t)&&r(t),void 0===d&&(d={}),void 0===d.align&&(d.align="center"),void 0===d.showArrow&&(d.showArrow=!0),void 0===d.preferedPositions&&(d.preferedPositions=["bottom","top","left","right"]),void 0===d.onHide&&(d.onHide=null),void 0===d.hideOnWindowWidthChange&&(d.hideOnWindowWidthChange=!1),void 0===d.hideOnClick&&(d.hideOnClick=!1),void 0===d.hideOnKeyDown&&(d.hideOnKeyDown=!1);var u=function(){if(i(t))return r(t),!0},v=document.body;if(void 0!==d.contentContainer){v=d.contentContainer;var f=getComputedStyle(v).position;-1===["relative","absolute","fixed"].indexOf(f)&&v.style.setProperty("position","relative")}var h=v===document.body?p(a):null,w=s(a),y=document.createElement("div");y.setAttribute("data-tooltip",""),y.setAttribute("role","tooltip"),y.style.position=null!==h?"fixed":"absolute",y.style.zIndex=(null!==w?w:0)+10,"string"==typeof l?y.innerHTML=l:y.appendChild(l),v.appendChild(y);var m=getComputedStyle(y),g=function(t,o){var e=m.getPropertyValue(t);return""!==e?e:o},b=null;if(void 0!==d.onBeforeShow)try{var x=d.onBeforeShow(y);"object"==typeof x&&"function"==typeof x.then&&(b=x)}catch(t){}var k=function(){if(g("--form-tooltip-arrow-size",""),void 0===d.contentSpacing&&(d.contentSpacing=parseInt(g("--tooltip-content-spacing","12px").replace("px",""))),void 0===d.arrowSize&&(d.arrowSize=parseInt(g("--tooltip-arrow-size","8px").replace("px",""))),void 0===d.maxWidth&&(d.maxWidth=g("--tooltip-max-width",null)),null!==d.maxWidth&&(y.style.maxWidth=d.maxWidth),o[t]=[a,y,u,d,h],y.style.backgroundColor=g("--tooltip-background-color","#eee"),y.style.border=g("--tooltip-border"),y.style.borderRadius=g("--tooltip-border-radius"),n(t),c(a),e.addHandler(u),void 0!==d.onShow)try{d.onShow(y)}catch(t){}};null!==b?b.then(k):k()},hide:r,hideAll:function(){for(var t in o)r(t)},isVisible:i,addClickListener:function(t,o,e){void 0===e&&(e={});var n=void 0!==e.preventDefault&&e.preventDefault,r=void 0!==e.stopPropagation&&e.stopPropagation;t.addEventListener("click",(function(t){n&&t.preventDefault(),r&&t.stopPropagation(),o()}))}}}();
EOT;
