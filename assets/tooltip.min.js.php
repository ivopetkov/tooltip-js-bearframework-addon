<?php

/*
 * Tooltip JS package for Bear Framework
 * https://github.com/ivopetkov/tooltip-js-bearframework-addon
 * Copyright (c) Ivo Petkov
 * Free to use under the MIT license.
 */

return <<<'EOT'
var ivoPetkov=ivoPetkov||{};ivoPetkov.bearFrameworkAddons=ivoPetkov.bearFrameworkAddons||{},ivoPetkov.bearFrameworkAddons.tooltip=ivoPetkov.bearFrameworkAddons.tooltip||function(){var t=0,e={},o=null;clientPackages.get("escapeKey").then((function(t){o=t}));var n=function(t){if(i(t)){var o=e[t],n=o[0],a=o[1],l=o[3],d=o[4],p=l.align,s=l.contentSpacing,c=l.arrowSize,v=a.style.backgroundColor,f=l.preferedPositions;a.style.top="-1000vh",a.style.left="-1000vw";for(var h=a.parentNode,w=window.innerWidth,y=window.innerHeight,b=n.getBoundingClientRect(),m=a.getBoundingClientRect(),g=h.getBoundingClientRect(),x=b.left,k=b.top,C=b.width,P=b.height,z=m.width,O=m.height,S=u(n),W=-1;W<S.length;W++){if(-1===W)var L=0,A=0,E=w,N=y;else{var H=S[W].getBoundingClientRect();L=H.top,A=H.left,E=H.width,N=H.height}if(L>k+P||L+N<k||A>A+C||A+E<A)return void r(t)}var D={};for(var F in f){var R=("top"===(K=f[F])||"bottom"===K?O+s:z+s)+5;R<1&&(R=1);var B=0;"top"===K?B=k:"bottom"===K?B=y-k-P:"left"===K?B=x:"right"===K&&(B=w-x-C),D[K]=R<B?2:1+B/R}var M=null,I=0;for(var F in f){var K;D[K=f[F]]>I&&(I=D[K],M=K)}var T=!1,q=!1;I>0&&I<2&&("top"===M||"bottom"===M?q=!0:"left"!==M&&"right"!==M||(T=!0));var V=0,j=0;if("top"===M?(V=k-O-s,j=x):"bottom"===M?(V=k+P+s,j=x):"left"===M?(V=k,j=x-z-s):"right"===M&&(V=k,j=x+C+s),"top"===M||"bottom"===M?("center"===p?j-=Math.floor((z-C)/2):"end"===p&&(j-=z-C),j+z+2>w&&(j=w-2-z)):"left"!==M&&"right"!==M||("center"===p?V-=Math.floor((O-P)/2):"end"===p&&(V-=O-P),V+O+2>y&&(V=y-2-O)),j<5&&(j=5),j+z>w-5&&(j=w-5-z),V<5&&(V=5),V+O>y-5&&(V=y-5-O),c>0){var G=null,J=null;if(T||q||("top"===M||"bottom"===M?(J="top"===M?O:-2*c,((G=x-j+(C-2*c)/2)<0||G>z-2*c)&&(G=null)):"left"!==M&&"right"!==M||(G="left"===M?z:-2*c,((J=k-V+(P-2*c)/2)<0||J>O-2*c)&&(J=null))),null!==G&&null!==J){var Q={top:v+" transparent transparent transparent",bottom:"transparent transparent "+v+" transparent",left:"transparent transparent transparent "+v,right:"transparent "+v+" transparent transparent"};a.style.setProperty("--tooltip-internal-arrow-size",c+"px"),a.style.setProperty("--tooltip-internal-arrow-colors",Q[M]),a.style.setProperty("--tooltip-internal-arrow-display","block"),a.style.setProperty("--tooltip-internal-arrow-left",G+"px"),a.style.setProperty("--tooltip-internal-arrow-top",J+"px")}else a.style.removeProperty("--tooltip-internal-arrow-display"),a.style.removeProperty("--tooltip-internal-arrow-left"),a.style.removeProperty("--tooltip-internal-arrow-top")}null===d&&(V-=g.top,j-=g.left),a.style.top=V+"px",a.style.left=j+"px"}},r=function(t){if(i(t)){for(var n=f(t),a=0;a<n.length;a++)r(n[a]);var l=e[t],d=l[1],p=k(t);if(o.removeHandler(l[2]),d.parentNode.removeChild(d),delete e[t],null!==p.onHide)try{p.onHide()}catch(t){}}},i=function(t){return void 0!==e[t]},a=function(t,o){if(void 0!==e[t]&&e[t][0].contains(o))return!0;return!1},l=function(t,o){if(void 0!==e[t]&&e[t][1].contains(o))return!0;return!1},d=function(t){var o=[];if(void 0!==e[t]){var n=e[t];for(var r in e)r!==t&&l(r,n[0])&&(o.push(r),o=o.concat(d(r)))}return h(o)},p=function(t){for(;null!==t.parentNode&&t!==document.body;){if("fixed"===getComputedStyle(t).position)return t;t=t.parentNode}return null},s=function(t){for(;null!==t.parentNode&&t!==document.body;){var e=getComputedStyle(t).zIndex;if(null!==e&&!isNaN(e))return e;t=t.parentNode}return null},u=function(t){for(var e=[];null!==t&&t!==document.body;)(t.scrollTop>0||t.scrollLeft>0)&&e.push(t),t=t.parentNode;return e},c=[],v=function(t){for(;null!==t.parentNode&&t!==document.body;)-1===c.indexOf(t)&&(t.addEventListener("scroll",b),c.push(t)),t=t.parentNode},f=function(t){var o=[];if(void 0!==e[t])for(var n in e)n!==t&&l(t,e[n][0])&&(o.push(n),o=o.concat(f(n)));return h(o)},h=t=>t.filter((t,e,o)=>o.indexOf(t)===e),w=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)},y=null,b=function(){y=!0},m=function(){null!==y&&(!function(){for(var t in e)n(t)}(),y=null),w(m)};m();var g=window.innerWidth,x=function(){if(g!==window.innerWidth){for(var t in e)k(t).hideOnWindowWidthChange&&r(t);g=window.innerWidth}},k=function(t){return void 0!==e[t]?e[t][3]:null},C=!1,P=function(){if(!C&&null!==document.body){C=!0,document.body.addEventListener("mousedown",(function(t){var o=t.target,n=[];for(var i in e){k(i).hideOnClick||(a(i,o)||l(i,o))&&(n.push(i),n=n.concat(d(i)))}for(var i in n=h(n),e)-1===n.indexOf(i)&&r(i)})),document.body.addEventListener("keydown",(function(){for(var t in e){k(t).hideOnKeyDown&&r(t)}})),window.addEventListener("resize",x),document.addEventListener("scroll",b),window.addEventListener("resize",b),window.addEventListener("orientationchange",b);var t=document.createElement("style");'[data-tooltip]:before{content:"";top:0;left:0;display:block;width:0;height:0;border-color:var(--tooltip-internal-arrow-colors);border-width:var(--tooltip-internal-arrow-size,0);border-style:solid;z-index:1;position:absolute;transform:rotate(0);display:var(--tooltip-internal-arrow-display,none);top:var(--tooltip-internal-arrow-top,0);left:var(--tooltip-internal-arrow-left,0);}',t.innerHTML='[data-tooltip]{position:relative;box-sizing:border-box;max-width:calc(100vw - 10px);max-height:calc(100vh - 10px);}[data-tooltip]:before{content:"";top:0;left:0;display:block;width:0;height:0;border-color:var(--tooltip-internal-arrow-colors);border-width:var(--tooltip-internal-arrow-size,0);border-style:solid;z-index:1;position:absolute;transform:rotate(0);display:var(--tooltip-internal-arrow-display,none);top:var(--tooltip-internal-arrow-top,0);left:var(--tooltip-internal-arrow-left,0);}',document.head.appendChild(t),"undefined"!=typeof MutationObserver&&new MutationObserver((function(){for(var t in e)document.body.contains(e[t][0])||r(t)})).observe(document.body,{attributes:!0,childList:!0,subtree:!0})}};document.addEventListener("readystatechange",()=>{P()}),P();return{generateID:function(){return"tt"+ ++t},show:function(t,a,l,d){i(t)&&r(t),void 0===d&&(d={}),void 0===d.align&&(d.align="center"),void 0!==d.showArrow&&!1===d.showArrow&&(d.arrowSize=0),void 0===d.preferedPositions&&(d.preferedPositions=["bottom","top","left","right"]),void 0===d.onHide&&(d.onHide=null),void 0===d.hideOnWindowWidthChange&&(d.hideOnWindowWidthChange=!1),void 0===d.hideOnClick&&(d.hideOnClick=!1),void 0===d.hideOnKeyDown&&(d.hideOnKeyDown=!1);var u=function(){if(i(t))return r(t),!0},c=document.body;if(void 0!==d.contentContainer){c=d.contentContainer;var f=getComputedStyle(c).position;-1===["relative","absolute","fixed"].indexOf(f)&&c.style.setProperty("position","relative")}var h=c===document.body?p(a):null,w=s(a),y=document.createElement("div");y.setAttribute("data-tooltip",""),y.setAttribute("role","tooltip"),y.style.position=null!==h?"fixed":"absolute",y.style.zIndex=(null!==w?w:0)+10,"string"==typeof l?y.innerHTML=l:y.appendChild(l),c.appendChild(y);var b=getComputedStyle(y),m=function(t,e){var o=b.getPropertyValue(t);return""!==o?o:e},g=null;if(void 0!==d.onBeforeShow)try{var x=d.onBeforeShow(y);"object"==typeof x&&"function"==typeof x.then&&(g=x)}catch(t){}var k=function(){if(void 0===d.contentSpacing&&(d.contentSpacing=parseInt(m("--tooltip-content-spacing","12px").replace("px",""))),void 0===d.arrowSize&&(d.arrowSize=parseInt(m("--tooltip-arrow-size","8px").replace("px",""))),void 0===d.maxWidth&&(d.maxWidth=m("--tooltip-max-width",null)),null!==d.maxWidth&&(y.style.maxWidth=d.maxWidth),e[t]=[a,y,u,d,h],y.style.backgroundColor=m("--tooltip-background-color","#eee"),y.style.border=m("--tooltip-border"),y.style.borderRadius=m("--tooltip-border-radius"),n(t),v(a),o.addHandler(u),void 0!==d.onShow)try{d.onShow(y)}catch(t){}};null!==g?g.then(k):k()},hide:r,hideAll:function(){for(var t in e)r(t)},isVisible:i,hasVisible:function(){for(var t in e)return!0;return!1},addClickListener:function(t,e,o){void 0===o&&(o={});var n=void 0!==o.preventDefault&&o.preventDefault,r=void 0!==o.stopPropagation&&o.stopPropagation;t.addEventListener("click",(function(t){n&&t.preventDefault(),r&&t.stopPropagation(),e()}))}}}();
EOT;
