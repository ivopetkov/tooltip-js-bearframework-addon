<?php

/*
 * Tooltip JS package for Bear Framework
 * https://github.com/ivopetkov/tooltip-js-bearframework-addon
 * Copyright (c) Ivo Petkov
 * Free to use under the MIT license.
 */

return <<<'EOT'
var ivoPetkov=ivoPetkov||{};ivoPetkov.bearFrameworkAddons=ivoPetkov.bearFrameworkAddons||{},ivoPetkov.bearFrameworkAddons.tooltip=ivoPetkov.bearFrameworkAddons.tooltip||function(){var t=0,o={},e=null;clientPackages.get("escapeKey").then((function(t){e=t}));var r=function(t){if(i(t)){var e=o[t],r=e[0],a=e[1],l=e[3],d=e[4],p=l.align,s=l.showArrow,v=l.contentSpacing,f=l.arrowSize,c=a.style.backgroundColor,h=l.preferedPositions;a.style.top="-1000vh",a.style.left="-1000vw";for(var w=a.parentNode,y=window.innerWidth,g=window.innerHeight,m=r.getBoundingClientRect(),b=a.getBoundingClientRect(),P=w.getBoundingClientRect(),x=m.left,k=m.top,C=Math.ceil(m.width),z=Math.ceil(m.height),A=Math.ceil(b.width),L=Math.ceil(b.height),S=u(r),N=-1;N<S.length;N++){if(-1===N)var E=0,W=0,H=y,M=g;else{var F=S[N].getBoundingClientRect();E=F.top,W=F.left,H=F.width,M=F.height}if(E>k+z||E+M<k||W>W+C||W+H<W)return void n(t)}var O={};for(var R in h){var B=("top"===(I=h[R])||"bottom"===I?L+v:A+v)+5;B<1&&(B=1);var D=0;"top"===I?D=k:"bottom"===I?D=g-k-z:"left"===I?D=x:"right"===I&&(D=y-x-C),O[I]=B<D?2:1+D/B}var T=null,q=0;for(var R in h){var I;O[I=h[R]]>q&&(q=O[I],T=I)}var V=!1,K=!1;q>0&&q<2&&("top"===T||"bottom"===T?K=!0:"left"!==T&&"right"!==T||(V=!0));var j=0,G=0;if("top"===T?(j=k-L-v,G=x):"bottom"===T?(j=k+z+v,G=x):"left"===T?(j=k,G=x-A-v):"right"===T&&(j=k,G=x+C+v),"top"===T||"bottom"===T?("center"===p?G-=Math.floor((A-C)/2):"end"===p&&(G-=A-C),G+A+2>y&&(G=y-2-A)):"left"!==T&&"right"!==T||("center"===p?j-=Math.floor((L-z)/2):"end"===p&&(j-=L-z),j+L+2>g&&(j=g-2-L)),G<5&&(G=5),G+A>y-5&&(G=y-5-A),j<5&&(j=5),j+L>g-5&&(j=g-5-L),s){var J=null,Q=null;if(V||K||("top"===T||"bottom"===T?(Q="top"===T?L:-2*f,((J=x-G+(C-2*f)/2)<0||J>A-2*f)&&(J=null)):"left"!==T&&"right"!==T||(J="left"===T?A:-2*f,((Q=k-j+(z-2*f)/2)<0||Q>L-2*f)&&(Q=null))),null!==J&&null!==Q){var U={top:c+" transparent transparent transparent",bottom:"transparent transparent "+c+" transparent",left:"transparent transparent transparent "+c,right:"transparent "+c+" transparent transparent"};a.style.setProperty("--tooltip-arrow-size",f+"px"),a.style.setProperty("--tooltip-arrow-colors",U[T]),a.style.setProperty("--tooltip-arrow-display","block"),a.style.setProperty("--tooltip-arrow-left",J+"px"),a.style.setProperty("--tooltip-arrow-top",Q+"px")}else a.style.removeProperty("--tooltip-arrow-display"),a.style.removeProperty("--tooltip-arrow-left"),a.style.removeProperty("--tooltip-arrow-top")}null===d&&(j-=P.top,G-=P.left),a.style.top=j+"px",a.style.left=G+"px"}},n=function(t){if(i(t)){for(var r=c(t),a=0;a<r.length;a++)n(r[a]);var l=o[t],d=l[1],p=l[3];if(e.removeHandler(l[2]),d.parentNode.removeChild(d),delete o[t],null!==p.onHide)try{p.onHide()}catch(t){}}},i=function(t){return void 0!==o[t]},a=function(t,e){if(void 0!==o[t]&&o[t][0].contains(e))return!0;return!1},l=function(t,e){if(void 0!==o[t]&&o[t][1].contains(e))return!0;return!1},d=function(t){var e=[];if(void 0!==o[t]){var r=o[t];for(var n in o)n!==t&&l(n,r[0])&&(e.push(n),e=e.concat(d(n)))}return h(e)},p=function(t){for(;null!==t.parentNode&&t!==document.body;){if("fixed"===getComputedStyle(t).position)return t;t=t.parentNode}return null},s=function(t){for(;null!==t.parentNode&&t!==document.body;){var o=getComputedStyle(t).zIndex;if(null!==o&&!isNaN(o))return o;t=t.parentNode}return null},u=function(t){for(var o=[];null!==t&&t!==document.body;)(t.scrollTop>0||t.scrollLeft>0)&&o.push(t),t=t.parentNode;return o},v=[],f=function(t){for(;null!==t.parentNode&&t!==document.body;)-1===v.indexOf(t)&&(t.addEventListener("scroll",g),v.push(t)),t=t.parentNode},c=function(t){var e=[];if(void 0!==o[t])for(var r in o)r!==t&&l(t,o[r][0])&&(e.push(r),e=e.concat(c(r)));return h(e)},h=t=>t.filter((t,o,e)=>e.indexOf(t)===o),w=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)},y=null,g=function(){y=!0},m=function(){null!==y&&(!function(){for(var t in o)r(t)}(),y=null),w(m)};m();var b=window.innerWidth,P=function(){if(b!==window.innerWidth){for(var t in o)o[t][3].hideOnWindowWidthChange&&n(t);b=window.innerWidth}},x=!1,k=function(){if(!x&&null!==document.body){x=!0,document.body.addEventListener("mousedown",(function(t){var e=t.target,r=[];for(var i in o)(a(i,e)||l(i,e))&&(r.push(i),r=r.concat(d(i)));for(var i in r=h(r),o)-1===r.indexOf(i)&&n(i)})),window.addEventListener("resize",P),document.addEventListener("scroll",g),window.addEventListener("resize",g),window.addEventListener("orientationchange",g);var t=document.createElement("style");'[data-tooltip]:before{content:"";top:0;left:0;display:block;width:0;height:0;border-color:var(--tooltip-arrow-colors);border-width:var(--tooltip-arrow-size,0);border-style:solid;z-index:1;position:absolute;transform:rotate(0);display:var(--tooltip-arrow-display,none);top:var(--tooltip-arrow-top,0);left:var(--tooltip-arrow-left,0);}',t.innerHTML='[data-tooltip]{position:relative;box-sizing:border-box;max-width:calc(100vw - 10px);max-height:calc(100vh - 10px);}[data-tooltip]:before{content:"";top:0;left:0;display:block;width:0;height:0;border-color:var(--tooltip-arrow-colors);border-width:var(--tooltip-arrow-size,0);border-style:solid;z-index:1;position:absolute;transform:rotate(0);display:var(--tooltip-arrow-display,none);top:var(--tooltip-arrow-top,0);left:var(--tooltip-arrow-left,0);}',document.head.appendChild(t)}};document.addEventListener("readystatechange",()=>{k()}),k();return{generateID:function(){return"tt"+ ++t},show:function(t,a,l,d){i(t)&&n(t),void 0===d&&(d={}),void 0===d.align&&(d.align="center"),void 0===d.showArrow&&(d.showArrow=!0),void 0===d.contentSpacing&&(d.contentSpacing=12),void 0===d.arrowSize&&(d.arrowSize=8),void 0===d.preferedPositions&&(d.preferedPositions=["bottom","top","left","right"]),void 0===d.onHide&&(d.onHide=null),void 0===d.hideOnWindowWidthChange&&(d.hideOnWindowWidthChange=!1);var u=function(){if(i(t))return n(t),!0},v=document.body;if(void 0!==d.contentContainer){v=d.contentContainer;var c=getComputedStyle(v).position;-1===["relative","absolute","fixed"].indexOf(c)&&v.style.setProperty("position","relative")}var h=v===document.body?p(a):null,w=s(a),y=document.createElement("div");y.setAttribute("data-tooltip",""),y.style.position=null!==h?"fixed":"absolute",y.style.zIndex=(null!==w?w:0)+10,"string"==typeof l?y.innerHTML=l:y.appendChild(l),v.appendChild(y);var g=getComputedStyle(y),m=function(t,o){var e=g.getPropertyValue(t);return""!==e?e:o};if(o[t]=[a,y,u,d,h],void 0!==d.onBeforeShow)try{d.onBeforeShow(y)}catch(t){}y.style.backgroundColor=m("--tooltip-background-color","#eee"),y.style.border=m("--tooltip-border"),y.style.borderRadius=m("--tooltip-border-radius"),r(t),f(a),e.addHandler(u)},hide:n,hideAll:function(){for(var t in o)n(t)},isVisible:i,addClickListener:function(t,o,e){void 0===e&&(e={});var r=void 0!==e.preventDefault&&e.preventDefault,n=void 0!==e.stopPropagation&&e.stopPropagation;t.addEventListener("click",(function(t){r&&t.preventDefault(),n&&t.stopPropagation(),o()}))}}}();
EOT;
